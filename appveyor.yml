# See http://www.appveyor.com/docs/appveyor-yml for many more options

version: 1.1.{build}

skip_commits:
  message: /readme.*|doc.*/

only_commits:
  files:
    - $env:APPVEYOR_PROJECT_NAME/
    - $env:APPVEYOR_PROJECT_NAME.nuspec

init:
- ps: |
    $PSVersionTable
    [System.Environment]::OSVersion

install:
- ps: |
    Install-Module -Name Pester, PSScriptAnalyzer, SplitPipeline -Force

build_script:
- ps: |
    $ModulePath = $env:PSModulePath -split ';' | select-object -first 1
    $ModuleRoot = Join-Path $ModulePath $env:APPVEYOR_PROJECT_NAME
    Copy-Item $env:APPVEYOR_PROJECT_NAME $ModuleRoot -Recurse

test_script:
- ps: |
    Invoke-Pester -EnableExit
